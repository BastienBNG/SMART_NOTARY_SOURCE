<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">

  <link rel="stylesheet" href="static/fonts/acceuil_fonts/icomoon/style.css">

  <link rel="stylesheet" href="static/css/acceuil css/owl.carousel.min.css">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="static/css/acceuil css/bootstrap.min.css">

  <!-- Style -->
  <link rel="stylesheet" href="static/css/acceuil css/style.css">

  <title>Smart Notary</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Landing Page - Start Bootstrap Theme</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="static/assets/favicon.ico" />
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet"
    type="text/css" />
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet"
    type="text/css" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="static/css/styles_landing_page.css" rel="stylesheet" />


  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-image: url('static/assets/img/background.jpg');
    }

    * {
      box-sizing: border-box;
    }

    /* Button used to open the contact form - fixed at the bottom of the page */
    .open-button {
      background-color: #555;
      color: rgb(255, 255, 255);
      padding: 16px 20px;
      border: none;
      cursor: pointer;
      opacity: 0.8;
      position: fixed;
      bottom: 23px;
      right: 28px;
      width: 280px;
    }

    /* The popup form - hidden by default */
    .form-popup {
      display: none;
      position: fixed;
      bottom: 0;
      right: 15px;
      border: 3px solid #f1f1f1;
      z-index: 9;
    }

    /* Add styles to the form container */
    .form-container {
      max-width: 300px;
      padding: 10px;
      background-color: white;
    }

    /* Full-width input fields */
    .form-container input[type=text],
    .form-container input[type=password] {
      width: 100%;
      padding: 15px;
      margin: 5px 0 22px 0;
      border: none;
      background: #f1f1f1;
    }

    /* When the inputs get focus, do something */
    .form-container input[type=text]:focus,
    .form-container input[type=password]:focus {
      background-color: #ddd;
      outline: none;
    }

    /* Set a style for the submit/login button */
    .form-container .btn {
      background-color: #04AA6D;
      color: white;
      padding: 16px 20px;
      border: none;
      cursor: pointer;
      width: 100%;
      margin-bottom: 10px;
      opacity: 0.8;
    }

    /* Add a red background color to the cancel button */
    .form-container .cancel {
      background-color: red;
    }

    /* Add some hover effects to buttons */
    .form-container .btn:hover,
    .open-button:hover {
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- Masthead-->
  <div class="site-mobile-menu site-navbar-target">
    <div class="site-mobile-menu-header">
      <div class="site-mobile-menu-close mt-3">
        <span class="icon-close2 js-menu-toggle"></span>
      </div>
    </div>
    <div class="site-mobile-menu-body"></div>
  </div>
  <header class="site-navbar site-navbar-target py-4" role="banner">
    <div class="container">
      <div style="text-align:center;"> <img src="static/assets/img/logo.jpg" width="250" height="100" /></div>
      <div class="row align-items-center position-relative">
        <div class="col-3 ml-auto text-right order-2">
          <div class="site-logo">
            <a href="welcome" class="font-weight-bold text-white">Se Déconnecter</a>
          </div>
        </div>
        <div class="col-9 order-1 text-left mr-auto text-white">


          <span class="d-inline-block d-lg-block"><a href="#"
              class="text-black site-menu-toggle js-menu-toggle py-5"><span
                class="icon-menu h3 text-black"></span></a></span>



          <nav class="site-navigation text-right ml-auto d-none d-lg-none" role="navigation">
            <ul class="site-menu main-menu js-clone-nav ml-auto ">
              <li class="active"><a href="acceuil" class="nav-link">Accueil</a></li>
              <li><a href="MesDocuments" class="nav-link">Mes Documents</a></li>
              <li><a href="certif" class="nav-link">Certifier un nouveau fichier</a></li>
              <li><a href="Parametre" class="nav-link">Paramètres</a></li>
              
            </ul>
          </nav>
        </div>


      </div>
    </div>

  </header>


  <br><br><br><br><br><br><br>
  <section class="features-icons bg-dark text-center">
    <div class="container">
      <div class="row">
        <div class="col align-self-center">
          <div class="features-icons-item mx-auto sm sm-0 sm-3 text-white">
            <div class="features-icons-icon d-flex"><i class="bi bi-check-lg m-auto text-light"></i></div>
            <h3>Certifier le document</h3>
            <p>Ici vous pouvez ajouter un document que vous souhaitez certifier</p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!--row-->
  <div id="uploader">
    <div class="row uploadDoc">
      <div class="col text-center">
        <img src="static/assets/img/upload.png" class="mx-auto d-block">
        <span class="upl text-white" id="upload">Soumettre un document
          <p>
            Le document doit être à l'un des formats suivants: 'pdf', 'docx', 'rtf', 'jpg', 'jpeg', 'png' pu 'text'.
          </p>
        </span>
        <input type="file" class="upload up" id="document_up" onchange="readURL(this);" />
      </div><!-- btn-orange -->
    </div><!-- col-3 -->

    <!--col-8--> <br><br><br>
    <div class="col-sm-1"><a class="btn-check"><i class="fa fa-times"></i></a></div><!-- col-1 -->
  </div>
  <!--row-->
  </div>
  <!--uploader-->
  <div class="col text-center">
    <div class="text-white">
      <h4>Quel type de documents souhaitez-vous certifier ?</h4>
    </div>
    <!--Using multiple to select multiple value-->
    <br>
    <select name="subject">
      <option value="">Choisissez un type de fichier</option>
      <option value="Diplome">Diplôme</option>
      <option value="Diplome2">Autre type de document à venir</option>

    </select>
    <br>
    <br><button type="button" class="btn btn-dark" data-toggle="modal" data-target="#exampleModal"
      data-whatever="@mdo">Ajouter les informations</button>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Veuillez rentrer les informations de la personne diplômée.
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="sendForm" name="formDoc">
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Nom*:</label>
                <input type="text" class="form-control" name="last_name" required id="formname">
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Prénom*:</label>
                <input type="text" class="form-control" name="first_name" required id="formname">
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Date de naissance*:</label>
                <input type="date" class="form-control" name="birth_date" required id="formname">
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Genre*:</label>
                <select name="genre" required>
                  <option value="M">Homme</option>
                  <option value="F">Femme</option>
                </select>
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Pays de naissance*:</label>
                <select name="birth_country" required>
                  <option value="FR">France</option>
                  <option value="BE">Belgique</option>
                  <option value="CH">Suisse</option>
                  <option value="CA">Canada</option>
                </select>
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Niveau de diplôme*:</label>
                <select name="diploma_degree" required>
                  <option value="3">CAP,BEP</option>
                  <option value="4">Baccalauréat</option>
                  <option value="5">DEUG, BTS, DUT, DEUST</option>
                  <option value="6">Licence, licence professionnelle, BUT</option>
                  <option value="6">Maîtrise, master 1</option>
                  <option value="7">Master, diplôme d'études approfondies, diplôme d'études supérieures spécialisées,
                    diplôme d'ingénieur</option>
                  <option value="8">Doctorat, habilitation à diriger des recherches</option>
                </select>
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Type de diplôme*:</label>
                <select name="diploma_type" required>
                  <option value="BR">Brevet des collèges</option>
                  <option value="CA">Certificat d'Aptitude Professionnelle (CAP)</option>
                  <option value="BE">Brevet d'Etudes Professionnelles</option>
                  <option value="BA">Baccalauréat Général</option>
                  <option value="BP">Baccalauréat Profesionnel</option>
                  <option value="BS">Baccalauréat Technologique</option>
                  <option value="BT">Brevet Technicien Supérieur (BTS)</option>
                  <option value="DU">Diplôme Universitaire de Technologie (DUT)</option>
                  <option value="LC">Licence</option>
                  <option value="LP">Licence Professionnelle</option>
                  <option value="DE">Diplôme Européen d'Etudes Supérieures (DEES)</option>
                  <option value="MA">Master</option>
                  <option value="MB">Maîtrise en Administration des Affaires (MBA)</option>
                  <option value="IN">Diplôme d'Ingenieur</option>
                  <option value="DR">Doctorat</option>
                </select>
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Domaine*:</label>
                <input type="text" class="form-control" name="diploma_domain" required id="formname">
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">Mention:</label>
                <input type="text" class="form-control" name="diploma_mention" id="formname">
              </div>
              <div class="form-group">
                <label for="message-text" class="col-form-label">Spécialité:</label>
                <input class="form-control" name="diploma_speciality" id="messagetext"></input>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
            <button type="button" class="btn btn-primary" id="send">Importer le document</button>
          </div>
        </div>
      </div>
    </div>
  </div>



  <button class="open-button" onclick="openForm()">Contact</button>

  <div class="form-popup" id="myForm">
    <form class="form-container">
      <h1>Besoin d'aide ?</h1>

      <label for="name"><b>Nom</b></label>
      <input type="text" placeholder="Enter name" name="name" required id="name">

      <label for="email"><b>Email</b></label>
      <input type="text" placeholder="Enter Email" name="email" required id="email">

      <label for="text"><b>Message</b></label>
      <input type="text" placeholder="Enter text" name="text" required id="message">

      <button type="submit" class="btn" onclick="send()">Envoyer</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Fermer</button>
    </form>
  </div>




  <script type="module">



        import init, { convert } from './pkg/rustwebservice.js'
            
            async function converttou8(str) {
              await init()
              var data = convert(str)
              return data
            }

 




        document.getElementById("send").addEventListener("click", event => {
            sendData();
            
            
        });

   
    function openForm() {
      document.getElementById("myForm").style.display = "block";
    }

    function closeForm() {
      document.getElementById("myForm").style.display = "none";
    }
    function sendAll() {
      sendData();
      //sendFile();
      
      
    }
    function sendData() {
      var first_name = document.formDoc.first_name.value;
      var last_name = document.formDoc.last_name.value;
      var birth_date = document.formDoc.birth_date.value;
      var genre = document.formDoc.genre.value;
      var birth_country = document.formDoc.birth_country.value;
      var diploma_degree = document.formDoc.diploma_degree.value;
      var diploma_domain = document.formDoc.diploma_domain.value;
      var diploma_mention = document.formDoc.diploma_mention.value;
      var diploma_speciality = document.formDoc.diploma_speciality.value;
      var diploma_type = document.formDoc.diploma_type.value;

      //uid
      
      //var uid = sessionStorage.getItem("user_info").id;
      //console.log(uid)
      //doc name
      //var docname = first_name + "_" + last_name+ "_" + diploma_type
      //console.log(docname)


      let xhr = new XMLHttpRequest();
      var url = "../backend2ddoc/2ddoc"; //url du pod 2ddoc
      xhr.open("POST", url, true);
      xhr.setRequestHeader("Content-Type", "application/json");
      
     

      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          
          console.log("in2ddoc");
          var image = xhr.responseText;
           
          var data = converttou8(image);
          console.log(data);

          var imgsrc = "data:image/png;base64," + btoa(String.fromCharCode.apply(null, data));
          console.log(imgsrc);
          document.getElementById('image').src = imgsrc;

        }
      };
      var data = JSON.stringify({
        "last_name": last_name, "first_name": first_name, "genre":genre, "birth_date": birth_date,
        "birth_country": birth_country, "diploma_degree": diploma_degree, "diploma_domain": diploma_domain, "diploma_mention": diploma_mention,
        "diploma_speciality": diploma_speciality, "diploma_type": diploma_type
      });
      xhr.send(data);
    };

    function sendFile() {
      let file = document.getElementById("document_up").files[0];
      let entry = document.getElementById("document_up").files[0];
      console.log('sendFile', entry, file)
      fetch('../docmanagement/test' + encodeURIComponent(entry.name), { method: 'PUT', body: file }); //Pod doc management upload image
      alert('Your file has been uploaded');
      location.reload();
    }
  </script>
  

  

  <img id="image" src="" />



  <script src="static/js/acceuil_js/jquery-3.3.1.min.js"></script>
  <script src="static/js/acceuil_js/popper.min.js"></script>
  <script src="static/js/acceuil_js/bootstrap.min.js"></script>
  <script src="static/js/acceuil_js/jquery.sticky.js"></script>
  <script src="static/js/acceuil_js/main.js"></script>
</body>

</html>